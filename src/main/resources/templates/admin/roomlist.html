<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div th:replace="header.html::header"></div>
<script th:src="@{/js/roomlist.js}"></script>
<div class="container">
    <div class="row" th:each="room : ${roomEntities}">
        <div class="col-md-3">
            <button type="button" class="btn btn-outline-primary me-2" th:data-bs-target="${'#modal'+room.rnum}"
                    data-bs-toggle="modal">
                <img th:src="@{'/roomimg/'+${room.roomimgEntities.get(0).rimg}}" width="100%">
            </button>

        </div>
        <div class="col-md-9">
            <div class="row">
                <div class="col-md-6">
                    <div th:text="${room.rnum}"></div>
                    <div th:text="${room.rname}"></div>
                    <div th:text="${room.rprice}"></div>
                    <div th:text="${room.rarea}"></div>
                    <div th:text="${room.rmanagementfee}"></div>
                    <div th:text="${room.rcompletiondate}"></div>
                    <div th:text="${room.rstructure}"></div>
                </div>
                <div class="col-md-6">
                    <div th:text="${room.rfloor}"></div>
                    <div th:text="${room.rkind}"></div>
                    <div th:text="${#strings.listSplit(room.raddress,',')[0] }"></div> <!-- 타임리프 split : #strings.listSplit(모델명,'자르기 기준') -->
                    <div th:text="${room.rcontents}"></div>
                    <div th:text="${room.ractive}"></div>
                    <div th:text="${room.rtrans}"></div>
                    <div th:text="${room.memberEntity.m_id}"></div>
                </div>
                <div>
                    <button type="button" class="btn btn-primary" th:data-bs-target="${'#delete'+room.rnum}" data-bs-toggle="modal">삭제</button>
                    <a th:href="@{'/admin/update' + ${room.rnum} }"><button type="button" class="btn btn-primary">수정</button></a>
                    <button type="button" class="btn btn-primary" th:data-bs-target="${'#active'+room.rnum}" data-bs-toggle="modal">상태변경</button>
                </div>
            </div>
        </div>

        <!-- room 상태 모달 -->
        <div class="modal fade" tabindex="-1" th:id="${'active'+room.rnum}" data-bs-keyboard="false" data-bs-backdrop="static">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content rounded-4 shadow">
                    <div class="modal-body p-4 text-center">
                        <h5 class="mb-0">상태 변경</h5>
                        <p class="mb-0" id="activemsg">룸 상태 변경 승인</p>
                    </div>
                    <div class="modal-footer flex-nowrap p-0">
                        <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-2 m-0 rounded-0" style="font-size: 8px;" th:onclick="activeupdate([[${room.rnum}]], '검토중')">검토중<br>(거래불가)</button>
                        <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-2 m-0 rounded-0" style="font-size: 8px;" th:onclick="activeupdate([[${room.rnum}]], '거래승인')">거래승인<br>(거래가능)</button>
                        <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-2 m-0 rounded-0" style="font-size: 8px;" th:onclick="activeupdate([[${room.rnum}]], '거래확인')">거래확인<br>(거래완료승인대기)</button>
                        <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-2 m-0 rounded-0" style="font-size: 8px;" th:onclick="activeupdate([[${room.rnum}]], '거래완료승인')">거래완료승인<br>(거래가능)</button>
                        <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-4 m-0 rounded-0" data-bs-dismiss="modal" style="font-size: 8px;">취소</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 사진 확대 모달 -->
        <div class="modal fade" tabindex="-1" data-bs-keyboard="false" data-bs-backdrop="static" role="dialog" th:id="${'modal'+room.rnum}" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content rounded-5 shadow">
                    <div class="modal-header p-5 pb-4 border-bottom-0">
                        <h2 class="fw-bold mb-0">방 이미지</h2>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> <!-- 닫기 -->
                    </div>
                    <div class="modal-body p-5 pt-0">
                        <div th:id="${'carousel' +room.rnum}" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-inner"> <!-- 반복문 -->
                                <div class="carousel-item active">
                                    <img th:src="@{'/roomimg/'+${room.roomimgEntities.get(0).rimg} }" class="d-block w-100" alt="...">
                                </div>
                                <div class="carousel-item" th:each="roomimg : ${room.roomimgEntities}">
                                    <img th:src="@{'/roomimg/'+${roomimg.rimg} }"  class="d-block w-100" alt="...">
                                </div>
                            </div>

                            <button class="carousel-control-prev" type="button" th:data-bs-target="${'#carousel'+room.rnum}"
                                    data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" th:data-bs-target="${'#carousel'+room.rnum}"
                                    data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- room 삭제 모달 -->
        <div class="modal fade" tabindex="-1" th:id="${'delete'+room.rnum}" data-bs-keyboard="false" data-bs-backdrop="static">
            <div class="modal-dialog" role="document">
                <div class="modal-content rounded-4 shadow">
                    <div class="modal-body p-4 text-center">
                        <h5 class="mb-0">room 삭제</h5>
                        <p class="mb-0" id="deletemsg">게시물 삭제시 복구가 불가능합니다. 삭제하시겠습니까??</p>
                    </div>
                    <div class="modal-footer flex-nowrap p-0">
                        <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0 border-right" th:onclick="rdelete([[${room.rnum}]])"><strong>삭제</strong></button>
                        <button type="button" class="btn btn-lg btn-link fs-6 text-decoration-none col-6 m-0 rounded-0" data-bs-dismiss="modal">취소</button>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- -->
</div> <!-- -->

</body>
</html>